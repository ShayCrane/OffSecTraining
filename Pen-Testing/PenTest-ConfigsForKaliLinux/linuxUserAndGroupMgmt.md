### Managing Unix Users and Unix Groups

</br>

The database of Unix users and groups consists of the textual files /etc/passwd (list of users), /etc/shadow (encrypted passwords of users), /etc/group (list of groups), and /etc/gshadow (encrypted passwords of groups). Their formats are documented in passwd(5), shadow(5), group(5), and gshadow(5) respectively (see Manual Pages. While these files can be manually edited with tools like vipw and vigr, there are higher level tools to perform the most common operations.

Using getent to Consult the User Database

The getent (get entries) command checks the system databases (including those of users and groups) using the appropriate library functions, which in turn call the name service switch (NSS) modules configured in the /etc/nsswitch.conf file. The command takes one or two arguments: the name of the database to check, and a possible search key. Thus, the command getent passwd kaliuser1 will return the information from the user database regarding the user kaliuser1.

>root@kali:~# getent passwd kaliuser1
kaliuser1:x:1001:1001:Kali User,4444,123-867-5309,321-867-5309:/home/kaliuser1:/bin/bash


----


#### How to create non-privileged user accounts

Commands
</br></br>
Create new user account:
>adduser [newUserName]
</br>
>adduser stanley
</br></br>
Add a user to a group other than its default:
>adduser [UserName] [groupName]
</br>
>>adduser stanley pentesters

</br></br>

Configuration file:
>/etc/adduser.conf
</br>
Settings for the adduser command can be configured in adduser.conf
</br>
When a new user is added, its new home directory is populated with the contents of  /etc/skel/, which is a configuration template that provisions new users with the standard directories and .config files.


-------

#### How to modify existing user accounts or passwords

</br>

##### Commands (quoted from OffSec.com, PEN-103)

</br></br>
>passwd—permits
</br>

a regular user to change their password, which in turn, updates the /etc/shadow file.

</br></br>

>chfn—(CHange Full Name)

</br></br>
reserved for the super-user (root), modifies the GECOS, or "general information" field.

</br></br>

>chsh—(CHange SHell)

</br>
changes the user's login shell. However, available choices will be limited to those listed in /etc/shells; the administrator, on the other hand, is not bound by this restriction and can set the shell to any program chosen.

</br></br>
>chage—(CHange AGE)

allows the administrator to change the password expiration settings by passing the user name as an argument or list current settings using the -l user option. Alternatively, you can also force the expiration of a password using the passwd -e user command, which forces the user to change their password the next time they log in.
</br>

----


#### How to Disable a User Account

</br>

Disabling a user's account means the account is locked and the user cannot login or access the machine, while the account and its files/data remain preserved.
Commands

>passwd -l [userName]

</br>
Locks the account.
</br></br>

>passwd -u [userName]

</br>
Unlocks the account.

-------


#### How to Manage Unix Groups

</br>

>addgroup
</br>

adds new user group
</br></br>

>delgroup
</br>

deletes existing user group
</br></br>

>groupmod
</br>

modifies group's info (gid identifier)

</br></br>

>gpasswd group
</br>

chng pword for the group

>gpasswd -r group
</br>

deletes password for group

</br></br>

>newgrp
</br>

starts new shell

</br></br>

>sg
</br>

executes a command using chosen alternate group supplied with command

</br></br>

>setgid
</br>

files created in supplied directory to automatically belong to a given group

>id
</br>

prints current state of user to screen with uid variable (personal identifier), gid variable (current main group), and lists groups variable  (groups the user belongs to).
